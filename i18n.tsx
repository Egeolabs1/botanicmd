import React, { createContext, useContext, useState, useEffect } from 'react';
import { SupportedLanguage } from './types';

const translations = {
  en: {
    app_name: "BotanicMD",
    tagline: "Your Personal Botanical Assistant",
    hero_title: "Heal and Save",
    hero_highlight: "Your Plants.",
    hero_subtitle: "Stop yellow leaves and pests. Diagnose diseases instantly and get expert treatment plans to save your garden using advanced AI.",
    start_now: "Start Now",
    view_demo: "View Demo",
    used_by: "Used by +10,000 gardeners",
    upload_tab: "Upload Photo",
    search_tab: "Search Name",
    take_photo: "Take Photo",
    gallery: "Gallery",
    drag_drop: "Upload a photo of your plant",
    drag_drop_sub: "Drag and drop here or click to select",
    search_placeholder: "Ex: Snake Plant, Monstera...",
    consult_expert: "Consult Expert",
    identifying: "Consulting Expert",
    preparing_info: "Our AI is preparing botanical information.",
    error_title: "Oops! Something went wrong.",
    try_again: "Try Again",
    identify_another: "Identify Another Plant",
    save_plant: "Save",
    saved: "Saved",
    my_garden: "My Garden",
    identify: "Identify",
    water: "Water",
    light: "Light",
    soil: "Soil",
    climate: "Climate",
    toxicity: "Toxicity",
    propagation: "Propagation",
    fun_fact: "Fun Fact",
    health_diagnosis: "Health Diagnosis",
    symptoms: "Symptoms Identified",
    treatment: "Recommended Treatment",
    healthy: "Healthy",
    attention: "Needs Attention",
    share_text: "Found this amazing plant on BotanicMD!",
    link_copied: "Link copied to clipboard!",
    pwa_install: "Install BotanicMD",
    pwa_desc: "Add to your home screen for fast access and offline mode.",
    install_btn: "Install App",
    chat_title: "Ask the Expert",
    chat_placeholder: "Type your question...",
    garden_empty: "Your garden is empty",
    garden_empty_desc: "Save plants you identify to create your personal collection and unlock achievements!",
    start_identifying: "Start Identifying",
    gardener_profile: "Gardener Profile",
    daily_tip: "Tip of the Day",
    search_garden: "Search your garden...",
    filter_all: "All",
    filter_healthy: "Healthy",
    filter_sick: "Sick",
    filter_safe: "Safe",
    filter_toxic: "Toxic",
    print: "Print",
    download_pdf: "PDF",
    calendar_event: "Schedule Watering",
    new_plant: "+ New Plant",
    select_plant_title: "We found these options",
    select_plant_desc: "Which of these plants are you looking for?",
    cancel_search: "Cancel and search again",
    features_id: "Precise ID",
    features_id_desc: "Identify species, scientific names and facts in seconds.",
    features_doc: "Plant Doctor",
    features_doc_desc: "Diagnose yellow leaves, spots and pests. Get treatment recipes.",
    features_game: "Gamification",
    features_game_desc: "Collect plants, level up and unlock exclusive badges.",
    features_med: "Natural Medicine",
    features_med_desc: "Discover medicinal properties, health benefits and preparation methods.",
    footer_rights: "All rights reserved.",
    err_image_process: "Could not process image.",
    err_image_analyze: "Analysis failed. Ensure the photo is clear and contains a plant.",
    err_plant_not_found: "Plant not found. Please check spelling or try a different name.",
    err_network: "Network connection issue. Please check your internet.",
    err_unexpected: "An unexpected error occurred. Please try again.",
    continue_google: "Continue with Google",
    or_divider: "or continue with",
    profile: "Profile",
    settings: "Settings",
    subscription: "Subscription",
    usage_limit: "Monthly Usage",
    logout_confirm: "Are you sure you want to log out?",
    upgrade_plan: "Upgrade Plan",
    free_plan: "Free Plan",
    pro_plan: "Pro Plan",
    pro_feature: "Pro Feature",
    unlock_tools: "Unlock PDF, Calendar & Saving",
    unlock_chat: "Unlock Expert Chat",
    search_locked: "Search by name is a Pro feature",
    garden_locked: "My Garden is a Pro feature",
    care_guide: "Care Guide",
    care_locked: "Unlock Care Guide",
    health_locked: "View Treatment & Save Plant",
    fun_fact_locked: "Unlock Fun Facts",
    toxicity_locked: "Unlock Toxicity Info",
    medicinal_title: "Medicinal Properties",
    benefits: "Benefits",
    usage_method: "How to Use",
    // Landing Page
    nav_how_it_works: "How it Works",
    nav_features: "Features",
    nav_pricing: "Pricing",
    nav_about: "About",
    nav_blog: "Blog",
    stats_plants: "Plants Identified",
    stats_accuracy: "Diagnosis Accuracy",
    stats_users: "Happy Gardeners",
    how_it_works: "How It Works",
    step_1_title: "Snap a Photo",
    step_1_desc: "Take a clear photo of your plant or upload from your gallery.",
    step_2_title: "AI Analysis",
    step_2_desc: "Our advanced AI scans leaves and patterns to identify species and health issues.",
    step_3_title: "Get Care Plan",
    step_3_desc: "Receive instant identification, watering schedules, and treatment advice.",
    pricing_title: "Simple Pricing",
    pricing_subtitle: "Start for free, upgrade to save your garden.",
    plan_free_price: "Free",
    plan_pro_price: "$5.99/mo", // Base ref
    feature_basic_id: "Basic Identification",
    feature_limited_usage: "3 Identifications/month",
    feature_toxicity: "Toxicity Check",
    feature_unlimited: "Unlimited Identifications",
    feature_full_care: "Complete Care Guides",
    feature_health: "Advanced Health Diagnosis",
    feature_medicinal_props: "Medicinal Properties & Uses",
    feature_chat: "Chat with Botanist AI",
    feature_save: "Save to Garden",
    feature_export: "PDF & Calendar Export",
    faq_title: "Frequently Asked Questions",
    faq_1_q: "Is the identification accurate?",
    faq_1_a: "Our AI model is trained on millions of plant images and achieves over 98% accuracy for common species.",
    faq_2_q: "Can I cancel my subscription?",
    faq_2_a: "Yes, you can cancel anytime from your profile settings. No hidden fees.",
    faq_3_q: "Does it work offline?",
    faq_3_a: "The identification requires internet, but once saved to your garden, you can view your plants offline.",
    faq_4_q: "Is my personal data safe?",
    faq_4_a: "Absolutely. We use bank-level encryption to protect your data and photos. We never share your personal information with third parties without your consent.",
    cta_title: "Ready to grow your garden?",
    cta_subtitle: "Join thousands of plant lovers today.",
    cta_button: "Get Started for Free",
    // About Us
    about_us: "About Us",
    about_title: "Cultivating a Greener World",
    about_mission: "Our Mission",
    about_mission_text: "We believe everyone should experience the joy of gardening. Our mission is to demystify botany and make plant care accessible to everyone, from urban apartment dwellers to experienced horticulturists.",
    about_story: "Our Story",
    about_story_text: "BotanicMD started as a passion project by Egeolabs. We combined our love for nature with cutting-edge Artificial Intelligence to create the ultimate pocket companion for plant lovers.",
    about_vision: "The Vision",
    about_vision_text: "To build the world's most comprehensive digital botanical encyclopedia, fostering a global community connected by their love for nature and sustainability.",
    footer_developed_by: "Developed by Egeolabs",
    // Luxometer
    lux_title: "Light Meter (Lux)",
    lux_desc: "Point your camera at the spot where you want to put your plant to measure light intensity.",
    lux_low: "Low Light (Shade)",
    lux_medium: "Medium Light (Indirect)",
    lux_high: "High Light (Direct Sun)",
    lux_advice_low: "Good for Snake Plant, ZZ Plant, Pothos.",
    lux_advice_medium: "Perfect for Monstera, Philodendron, Ferns.",
    lux_advice_high: "Great for Succulents, Cacti, Herbs.",
    start_measure: "Start Measuring",
    stop_measure: "Stop",
    // Profile & Settings
    edit_profile: "Edit Profile",
    your_name: "Your Name",
    save_changes: "Save Changes",
    notifications: "Notifications",
    enable_notifications: "Enable Push Notifications",
    app_language: "App Language",
    back: "Back",
    manage_sub: "Manage Subscription",
    cancel_subscription: "Cancel Subscription",
    cancel_subscription_info: "In a live app, this would redirect you to the Stripe customer portal to manage your subscription.",
    profile_updated: "Profile updated successfully!",
    current_plan: "Current Plan",
    plan_renewal: "Renews on",
    // Blog
    blog_title: "Botanical Insights",
    blog_subtitle: "Tips, tricks, and deep dives into the world of plants.",
    read_more: "Read More",
    back_home: "Back to Home",
    // New Pricing Strings
    plan_monthly: "Monthly",
    plan_annual: "Annual",
    plan_lifetime: "Lifetime",
    price_monthly: "$5.99",
    price_annual: "$29.99",
    price_lifetime: "$79.99",
    per_month_equiv: "Just $2.49/mo",
    save_percent: "SAVE 58%",
    lifetime_desc: "One-time payment. No subscriptions.",
    best_value: "BEST VALUE",
    unlock_urgency: "Save Your Plant Now",
    secure_payment: "Secure Payment via Store",
    app_footer_credit: "Developed by Egeolabs 2025"
  },
  pt: {
    app_name: "BotanicMD",
    tagline: "Seu Assistente Botânico Pessoal",
    hero_title: "Cure e Salve",
    hero_highlight: "Suas Plantas.",
    hero_subtitle: "Acabe com folhas amarelas e pragas. Diagnostique doenças instantaneamente e receba tratamentos especialistas para salvar seu jardim.",
    start_now: "Começar Agora",
    view_demo: "Ver Demo",
    used_by: "Usado por +10.000 jardineiros",
    upload_tab: "Enviar Foto",
    search_tab: "Buscar Nome",
    take_photo: "Tirar Foto",
    gallery: "Galeria",
    drag_drop: "Envie uma foto da sua planta",
    drag_drop_sub: "Arraste e solte aqui ou clique para selecionar",
    search_placeholder: "Ex: Espada de São Jorge, Jiboia...",
    consult_expert: "Consultar Especialista",
    identifying: "Consultando Especialista",
    preparing_info: "Nossa IA está preparando as informações botânicas.",
    error_title: "Oops! Algo deu errado.",
    try_again: "Tentar Novamente",
    identify_another: "Identificar Outra Planta",
    save_plant: "Salvar",
    saved: "Salvo",
    my_garden: "Meu Jardim",
    identify: "Identificar",
    water: "Água",
    light: "Luz",
    soil: "Solo",
    climate: "Clima",
    toxicity: "Toxicidade",
    propagation: "Propagação",
    fun_fact: "Curiosidade",
    health_diagnosis: "Diagnóstico de Saúde",
    symptoms: "Sintomas Identificados",
    treatment: "Tratamento Recomendado",
    healthy: "Saudável",
    attention: "Requer Atenção",
    share_text: "Encontrei esta planta incrível no BotanicMD!",
    link_copied: "Link copiado para a área de transferência!",
    pwa_install: "Instalar BotanicMD",
    pwa_desc: "Instale para acesso rápido e modo offline.",
    install_btn: "Instalar App",
    chat_title: "Pergunte ao Especialista",
    chat_placeholder: "Digite sua pergunta...",
    garden_empty: "Seu jardim está vazio",
    garden_empty_desc: "Salve as plantas que você identificar para criar sua coleção pessoal e desbloquear conquistas!",
    start_identifying: "Começar a Identificar",
    gardener_profile: "Perfil do Jardineiro",
    daily_tip: "Dica do Dia",
    search_garden: "Buscar no seu jardim...",
    filter_all: "Todas",
    filter_healthy: "Saudáveis",
    filter_sick: "Doentes",
    filter_safe: "Seguras",
    filter_toxic: "Tóxicas",
    print: "Imprimir",
    download_pdf: "PDF",
    calendar_event: "Agendar Rega",
    new_plant: "+ Nova Planta",
    select_plant_title: "Encontramos essas opções",
    select_plant_desc: "Qual dessas plantas você está procurando?",
    cancel_search: "Cancelar e buscar novamente",
    features_id: "Identificação Precisa",
    features_id_desc: "Identifique espécies, nomes científicos e fatos em segundos.",
    features_doc: "Doutor Planta",
    features_doc_desc: "Diagnostique folhas amarelas, manchas e pragas. Receba receitas.",
    features_game: "Gamificação",
    features_game_desc: "Colecione plantas, suba de nível e desbloqueie medalhas exclusivas.",
    features_med: "Medicina Natural",
    features_med_desc: "Descubra propriedades medicinais, benefícios para a saúde e formas de preparo.",
    footer_rights: "Todos os direitos reservados.",
    err_image_process: "Não foi possível processar a imagem.",
    err_image_analyze: "Falha na análise. Garanta que a foto esteja clara e mostre a planta.",
    err_plant_not_found: "Planta não encontrada. Verifique o nome ou tente outro.",
    err_network: "Erro de conexão. Verifique sua internet.",
    err_unexpected: "Ocorreu um erro inesperado. Tente novamente.",
    continue_google: "Continuar com Google",
    or_divider: "ou continue com",
    profile: "Perfil",
    settings: "Configurações",
    subscription: "Assinatura",
    usage_limit: "Uso Mensal",
    logout_confirm: "Tem certeza que deseja sair?",
    upgrade_plan: "Salvar Minha Planta",
    free_plan: "Plano Gratuito",
    pro_plan: "Plano Pro",
    pro_feature: "Recurso Pro",
    unlock_tools: "Desbloquear PDF, Agenda e Salvar",
    unlock_chat: "Desbloquear Chat Especialista",
    search_locked: "Busca por nome é exclusiva Pro",
    garden_locked: "Meu Jardim é exclusivo Pro",
    care_guide: "Guia de Cuidados",
    care_locked: "Desbloquear Guia de Cuidados",
    health_locked: "Ver Tratamento e Salvar Planta",
    fun_fact_locked: "Desbloquear Curiosidades",
    toxicity_locked: "Desbloquear Toxicidade",
    medicinal_title: "Propriedades Medicinais",
    benefits: "Benefícios",
    usage_method: "Como Usar",
    // Landing Page
    nav_how_it_works: "Como Funciona",
    nav_features: "Funcionalidades",
    nav_pricing: "Preços",
    nav_about: "Sobre",
    nav_blog: "Blog",
    stats_plants: "Plantas Identificadas",
    stats_accuracy: "Precisão no Diagnóstico",
    stats_users: "Jardineiros Felizes",
    how_it_works: "Como Funciona",
    step_1_title: "Tire uma Foto",
    step_1_desc: "Tire uma foto clara da sua planta ou envie da galeria.",
    step_2_title: "Análise com IA",
    step_2_desc: "Nossa IA avançada escaneia folhas e padrões para identificar a espécie.",
    step_3_title: "Receba o Plano",
    step_3_desc: "Receba identificação, agenda de rega e tratamento instantâneo.",
    pricing_title: "Preços Simples",
    pricing_subtitle: "Comece grátis, evolua para profissional.",
    plan_free_price: "Grátis",
    plan_pro_price: "R$ 19,90/mês", // Ref only
    feature_basic_id: "Identificação Básica",
    feature_limited_usage: "3 Identificações/mês",
    feature_toxicity: "Checagem de Toxicidade",
    feature_unlimited: "Identificações Ilimitadas",
    feature_full_care: "Guias de Cuidado Completos",
    feature_health: "Diagnóstico Avançado de Saúde",
    feature_medicinal_props: "Propriedades Medicinais e Usos",
    feature_chat: "Chat com Botânico IA",
    feature_save: "Salvar no Jardim",
    feature_export: "Exportar PDF e Calendário",
    faq_title: "Perguntas Frequentes",
    faq_1_q: "A identificação é precisa?",
    faq_1_a: "Nosso modelo é treinado em milhões de imagens e alcança +98% de precisão para espécies comuns.",
    faq_2_q: "Posso cancelar minha assinatura?",
    faq_2_a: "Sim, você pode cancelar a qualquer momento nas configurações. Sem taxas ocultas.",
    faq_3_q: "Funciona offline?",
    faq_3_a: "A identificação requer internet, mas após salvar no jardim, você pode ver suas plantas offline.",
    faq_4_q: "Meus dados pessoais estão seguros?",
    faq_4_a: "Absolutamente. Usamos criptografia de nível bancário para proteger seus dados e fotos. Nunca compartilhamos suas informações pessoais com terceiros sem seu consentimento.",
    cta_title: "Pronto para cultivar?",
    cta_subtitle: "Junte-se a milhares de amantes de plantas hoje.",
    cta_button: "Começar Gratuitamente",
    // About Us
    about_us: "Sobre Nós",
    about_title: "Cultivando um Mundo Mais Verde",
    about_mission: "Nossa Missão",
    about_mission_text: "Acreditamos que todos deveriam experimentar a alegria da jardinagem. Nossa missão é desmistificar a botânica e tornar o cuidado com plantas acessível a todos, desde moradores de apartamentos urbanos até horticultores experientes.",
    about_story: "Nossa História",
    about_story_text: "O BotanicMD começou como um projeto apaixonado da Egeolabs. Combinamos nosso amor pela natureza com Inteligência Artificial de ponta para criar o melhor companheiro de bolso para amantes de plantas.",
    about_vision: "A Visão",
    about_vision_text: "Construir a enciclopédia botânica digital mais abrangente do mundo, promovendo uma comunidade global conectada pelo amor à natureza e à sustentabilidade.",
    footer_developed_by: "Desenvolvido por Egeolabs",
    // Luxometer
    lux_title: "Medidor de Luz (Lux)",
    lux_desc: "Aponte a câmera para o local onde quer colocar a planta para medir a intensidade da luz.",
    lux_low: "Baixa Luz (Sombra)",
    lux_medium: "Luz Média (Indireta)",
    lux_high: "Luz Alta (Sol Direto)",
    lux_advice_low: "Bom para Espada de São Jorge, Zamioculca, Jiboia.",
    lux_advice_medium: "Perfeito para Monstera, Filodendro, Samambaias.",
    lux_advice_high: "Ótimo para Suculentas, Cactos, Ervas.",
    start_measure: "Começar Medição",
    stop_measure: "Parar",
    // Profile & Settings
    edit_profile: "Editar Perfil",
    your_name: "Seu Nome",
    save_changes: "Salvar Alterações",
    notifications: "Notificações",
    enable_notifications: "Ativar Notificações Push",
    app_language: "Idioma do App",
    back: "Voltar",
    manage_sub: "Gerenciar Assinatura",
    cancel_subscription: "Cancelar Assinatura",
    cancel_subscription_info: "Num app real, isto te levaria ao portal de clientes do Stripe para gerenciar sua assinatura.",
    profile_updated: "Perfil atualizado com sucesso!",
    current_plan: "Plano Atual",
    plan_renewal: "Renova em",
    // Blog
    blog_title: "Insights Botânicos",
    blog_subtitle: "Dicas, truques e mergulhos profundos no mundo das plantas.",
    read_more: "Ler Mais",
    back_home: "Voltar para Início",
    // New Pricing Strings
    plan_monthly: "Mensal",
    plan_annual: "Anual",
    plan_lifetime: "Vitalício",
    price_monthly: "R$ 19,90",
    price_annual: "R$ 99,90",
    price_lifetime: "R$ 289,90",
    per_month_equiv: "Apenas R$ 8,30/mês",
    save_percent: "ECONOMIZE 58%",
    lifetime_desc: "Pagamento único. Sem assinaturas.",
    best_value: "MELHOR VALOR",
    unlock_urgency: "Salvar Minha Planta Agora",
    secure_payment: "Pagamento Seguro via Store",
    app_footer_credit: "Desenvolvido por Egeolabs 2025"
  },
};

// Exemplo: Adicionando Euro para Espanhol, Francês e Alemão
['es', 'fr', 'de'].forEach(lang => {
    // @ts-ignore
    translations[lang] = { 
      ...translations['en'], 
      plan_pro_price: "€ 4.99/mo",
      price_monthly: "€ 5.99",
      price_annual: "€ 29.99",
      price_lifetime: "€ 79.99",
      per_month_equiv: "€ 2.49/mo"
    };
});

interface LanguageContextProps {
  language: SupportedLanguage;
  setLanguage: (lang: SupportedLanguage) => void;
  t: (key: keyof typeof translations['en']) => string;
}

const LanguageContext = createContext<LanguageContextProps | undefined>(undefined);

export const LanguageProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {
  const [language, setLanguage] = useState<SupportedLanguage>('en');

  useEffect(() => {
    const browserLang = navigator.language.split('-')[0] as SupportedLanguage;
    if (['en', 'pt', 'fr', 'de', 'es', 'ru', 'hi'].includes(browserLang)) {
      setLanguage(browserLang);
    } else {
      setLanguage('en');
    }
  }, []);

  const t = (key: keyof typeof translations['en']) => {
    const langData = translations[language as keyof typeof translations] || translations['en'];
    // @ts-ignore
    return langData[key] || translations['en'][key] || key;
  };

  return (
    <LanguageContext.Provider value={{ language, setLanguage, t }}>
      {children}
    </LanguageContext.Provider>
  );
};

export const useLanguage = () => {
  const context = useContext(LanguageContext);
  if (!context) {
    throw new Error('useLanguage must be used within a LanguageProvider');
  }
  return context;
};